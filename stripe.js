function setup(){createCanvas(windowWidth,windowHeight);for(var s=0;s<150;s++){var t=new Rope(map(s,0,150,width/2-width,width/2+width),0,10);ropes.push(t)}}function draw(){background(255),collisionSize=cs,noStroke(),fill(255,241,1),ellipse(mouseX,mouseY,2*collisionSize,2*collisionSize);for(var s=0;s<ropes.length;s++){for(var t=0;t<ropes[s].objs.length;t++)if(dist(mouseX,mouseY,ropes[s].objs[t].pos.x,ropes[s].objs[t].pos.y)<collisionSize){var i=new p5.Vector(ropes[s].objs[t].pos.x,ropes[s].objs[t].pos.y);i.sub(mouseX,mouseY),i.normalize(),i.mult(2),ropes[s].objs[t].acc.add(i)}ropes[s].display()}}function mouseDragged(){300==(cs+=10)&&(cs=20)}function Spring(s,t,i){this.pos=new p5.Vector(s,t),this.vel=new p5.Vector(0,0),this.acc=new p5.Vector(0,0),this.target=new p5.Vector(s,t),this.maxForce=i,this.move=function(){var s=new p5.Vector(this.target.x,this.target.y),t=dist(this.pos.x,this.pos.y,this.target.x,this.target.y),i=map(min(t,20),0,20,0,this.maxForce);s.sub(this.pos),s.normalize(),s.mult(i),this.acc.add(s),this.vel.mult(.8),this.vel.add(this.acc),this.pos.add(this.vel),this.acc.mult(0)}}function Pendulum(s,t,i){hg=.008*height,this.pos=new p5.Vector(s,t),this.vel=new p5.Vector(0,0),this.acc=new p5.Vector(0,0),this.mass=2,this.parent=i,this.restLength=p5.Vector.dist(this.pos,this.parent.pos),this.move=function(){var s=new p5.Vector(0,hg);s.div(this.mass),this.acc.add(s),this.vel.mult(.8),this.vel.limit(5),this.vel.add(this.acc),this.pos.add(this.vel),this.acc.mult(0);var t=p5.Vector.dist(this.pos,this.parent.pos),i=new p5.Vector(this.pos.x,this.pos.y);i.sub(this.parent.pos),i.normalize();var o=t-this.restLength;i.mult(-.1*o),i.div(this.mass),this.acc.add(i)},this.display=function(){null!=this.parent&&(strokeWeight(1),stroke(0),line(this.parent.pos.x,this.parent.pos.y,this.pos.x,this.pos.y)),strokeWeight(5),stroke(0,255,0),point(this.pos.x,this.pos.y)}}function Rope(s,t,i){hh=.02*height,ww=.006*width,this.objs=[],this.objs.push(new Spring(s,t,1));for(var o=0;o<i;o++)this.objs.push(new Pendulum(s,t+o*hh,this.objs[this.objs.length-1]));this.display=function(){noFill(),stroke(20),strokeWeight(ww),beginShape(),curveVertex(this.objs[0].pos.x,this.objs[0].pos.y);for(var s=0;s<this.objs.length;s++)this.objs[s].move(),curveVertex(this.objs[s].pos.x,this.objs[s].pos.y);curveVertex(this.objs[this.objs.length-1].pos.x,this.objs[this.objs.length-1].pos.y),endShape()}}var ropes=[],collisionSize,cs=80,hh,hg,ww;